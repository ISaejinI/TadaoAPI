<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <title>Tadao API</title>
</head>
<body>
    <header style="background-color: white;">
        <nav style="display: flex; justify-content: space-around; margin-bottom: 1rem;">
            <a href="#"><img src="logo_tadao.png" alt="logo_tadao" style="max-height: 3rem;"></a>
        </nav>
    </header>

    <div id="map"></div>
    <script>
        var map = L.map('map').setView([50.433333, 2.833333],13);
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);
        let points = [
            [50.427934471934776,2.8258932727752835],
            [50.42795931045276,2.825861277191624],
            [50.42795931045276,2.825861277191624],
            [50.42802206054232,2.825875934119084],
            [50.42802206054232,2.825875934119084],
            [50.42806703342149,2.8258482792080004],
            [50.42806703342149,2.8258482792080004],
            [50.42810336861933,2.825736262404288],
            [50.42810336861933,2.825736262404288],
            [50.42812159193278,2.8256662081802504],
            [50.42812159193278,2.8256662081802504],
            [50.42806831578606,2.825525227043325],
            [50.42806831578606,2.825525227043325],
            [50.42804151045802,2.825496873804745],
            [50.42804151045802,2.825496873804745],
            [50.42802427401111,2.825451262358589],
            [50.42802427401111,2.825451262358589],
            [50.42800155321376,2.8253911382274137],
            [50.42800155321376,2.8253911382274137],
            [50.42803315116112,2.8253422834511297],
            [50.42803315116112,2.8253422834511297],
            [50.428036232041656,2.82525898400653],
            [50.428036232041656,2.82525898400653],
            [50.42803998538155,2.8251575008369616],
            [50.42803998538155,2.8251575008369616],
            [50.4280622359932,2.8251050366053003],
            [50.4280622359932,2.8251050366053003],
            [50.42812150086795,2.824965296758644],
            [50.42812150086795,2.824965296758644],
            [50.42817295006744,2.824826685868256],
            [50.42817295006744,2.824826685868256],
            [50.42853911200219,2.82386357667599],
            [50.42853911200219,2.82386357667599],
            [50.428654066046604,2.823578709823368],
            [50.428654066046604,2.823578709823368],
            [50.42868747604776,2.823495916162483],
            [50.42868747604776,2.823495916162483],
            [50.42873561285934,2.8233860743353154],
            [50.42873561285934,2.8233860743353154],
            [50.42889441010851,2.823103213088249],
            [50.42889441010851,2.823103213088249],
            [50.42904849073079,2.822711400409],
            [50.42904849073079,2.822711400409],
            [50.429111518170096,2.82265582350962],
            [50.429111518170096,2.82265582350962],
            [50.429185671105614,2.8226298082326333],
            [50.429185671105614,2.8226298082326333],
            [50.4292724400749,2.822599366734793],
            [50.4292724400749,2.822599366734793],
            [50.42958081391829,2.822637121709658],
            [50.42958081391829,2.822637121709658],
            [50.42979806598487,2.8226647085339907],
            [50.42979806598487,2.8226647085339907],
            [50.42983552010843,2.822677712749299],
            [50.42983552010843,2.822677712749299],
            [50.42987689831815,2.82266039826726],
            [50.42987689831815,2.82266039826726],
            [50.42988858704175,2.8226998762942257],
            [50.42988858704175,2.8226998762942257],
            [50.42993674357534,2.822719989041063],
            [50.42993674357534,2.822719989041063],
            [50.43006319466952,2.8227542408035453],
            [50.43006319466952,2.8227542408035453],
            [50.43009807772461,2.8227636895959725],
            [50.43009807772461,2.8227636895959725],
            [50.430154070273744,2.822811590913419],
            [50.430154070273744,2.822811590913419],
            [50.43045702281115,2.82275311374204],
            [50.43045702281115,2.82275311374204],
            [50.4308966624209,2.822757365127577],
            [50.4308966624209,2.822757365127577],
            [50.43109495806966,2.822802407400024],
            [50.43109495806966,2.822802407400024],
            [50.43147082977918,2.822776964771369],
            [50.43147082977918,2.822776964771369],
            [50.43153153669784,2.8227689162465777],
            [50.43153153669784,2.8227689162465777],
            [50.431569579697474,2.8227638724944537],
            [50.431569579697474,2.8227638724944537],
            [50.4318746353329,2.8227668225582025],
            [50.4318746353329,2.8227668225582025],
            [50.43201819088359,2.8227682108358936],
            [50.43201819088359,2.8227682108358936],
            [50.43210791308899,2.82276907851348],
            [50.43210791308899,2.82276907851348],
            [50.43217997542998,2.822760378159633],
            [50.43217997542998,2.822760378159633],
            [50.432323357179065,2.8227430670720146],
            [50.432323357179065,2.8227430670720146],
            [50.432386273533,2.8227155805026447],
            [50.432386273533,2.8227155805026447],
            [50.43245744791199,2.822705662078096],
            [50.43245744791199,2.822705662078096],
            [50.4325748008896,2.8226893084238256],
            [50.4325748008896,2.8226893084238256],
            [50.432601939169935,2.8226333806145654],
            [50.432601939169935,2.8226333806145654],
            [50.43268701703598,2.8224830363063336],
            [50.43268701703598,2.8224830363063336],
            [50.43279168493505,2.8222980725438287],
            [50.43279168493505,2.8222980725438287],
            [50.43308095380909,2.821753007523349],
            [50.43308095380909,2.821753007523349],
            [50.4331713394483,2.8215853072622887],
            [50.4331713394483,2.8215853072622887],
            [50.43339730249933,2.821166053967724],
            [50.43339730249933,2.821166053967724],
            [50.43348779773651,2.820970257057267],
            [50.43348779773651,2.820970257057267],
            [50.43354196223283,2.820886492051955],
            [50.43354196223283,2.820886492051955],
            [50.43370462088304,2.820593053964493],
            [50.43370462088304,2.820593053964493],
            [50.43376792279256,2.8204672325167657],
            [50.43376792279256,2.8204672325167657],
            [50.43399377163159,2.820076064028459],
            [50.43399377163159,2.820076064028459],
            [50.4341926474977,2.819698680826252],
            [50.4341926474977,2.819698680826252],
            [50.43426492064881,2.819572943227989],
            [50.43426492064881,2.819572943227989],
            [50.43431016698852,2.819475041733144],
            [50.43431016698852,2.819475041733144],
            [50.43443671326875,2.8192374402008293],
            [50.43443671326875,2.8192374402008293],
            [50.434843375673225,2.8184967911587084],
            [50.434843375673225,2.8184967911587084],
            [50.43503321939325,2.8181333570747458],
            [50.43503321939325,2.8181333570747458],
            [50.43527738870249,2.8176440055711587],
            [50.43527738870249,2.8176440055711587],
            [50.43537679548154,2.817462328601753],
            [50.43537679548154,2.817462328601753],
            [50.43562982467156,2.8170011519666542],
            [50.43562982467156,2.8170011519666542],
            [50.4358077597974,2.816607107733252],
            [50.4358077597974,2.816607107733252],
            [50.43609982492445,2.816120586445709],
            [50.43609982492445,2.816120586445709],
            [50.436492143830286,2.8153734352506232],
            [50.436492143830286,2.8153734352506232],
            [50.43674751396771,2.814904706264411],
            [50.43674751396771,2.814904706264411],
            [50.43718439479731,2.814093852430945],
            [50.43718439479731,2.814093852430945],
            [50.43761837597371,2.813240989006365],
            [50.43761837597371,2.813240989006365],
            [50.43791657504469,2.812695904364514],
            [50.43791657504469,2.812695904364514],
            [50.43810634663202,2.81234647466237],
            [50.43810634663202,2.81234647466237],
            [50.438558205339085,2.8115077986910864],
            [50.438558205339085,2.8115077986910864],
            [50.43805933411306,2.810575847031805],
            [50.43805933411306,2.810575847031805],
            [50.43799701520206,2.8104488179709284],
            [50.43799701520206,2.8104488179709284],
            [50.43781875993631,2.8101380596472296],
            [50.43781875993631,2.8101380596472296],
            [50.43769406708362,2.809898052602574],
            [50.43769406708362,2.809898052602574],
            [50.43758758767398,2.809587973480563],
            [50.43758758767398,2.809587973480563],
            [50.43749018739304,2.80924988323853]
        ];
        var polyline = L.polyline(points, {color: 'red'}).addTo(map);
        map.fitBounds(polyline.getBounds());
    </script>

    <script>
        //Ajouter les 
        const req = new XMLHttpRequest();
        req.addEventListener("load", evt => {
        let data = JSON.parse(req.responseText);
        let filtre = data.shapes.map((v) => {
            let t = [];
            t.push(v.shape_pt_lat);
            t.push(v.shape_pt_lon);
            return t
        });
        L.polyline(filtre, {color: 'green'}).addTo(map);
        console.log(filtre);
        });
        req.open("GET", "http://127.0.0.1:8000/api/trips/9254340");
        req.send()
        
        //Ajouter les arrêts
        const req1 = new XMLHttpRequest();
        req1.addEventListener("load", evt => {
        let data = JSON.parse(req1.responseText);
        let filtre1 = data.stops.forEach(e => {
            let t1 = [];
            t1.push(e.stop_lat);
            t1.push(e.stop_lon);
            L.marker(t1, {title:e.stop_name}).addTo(map);
        });
        });
        req1.open("GET", "http://127.0.0.1:8000/api/trips/9254340/stops");
        req1.send()
    </script>
</body>
</html>